!function o(l,a,s){function u(t,e){if(!a[t]){if(!l[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(f)return f(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=a[t]={exports:{}};l[t][0].call(r.exports,function(e){return u(l[t][1][e]||e)},r,r.exports,o,l,a,s)}return a[t].exports}for(var f="function"==typeof require&&require,e=0;e<s.length;e++)u(s[e]);return u}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.IGNORE_TAGS=n.LENGTH_ATTR=n.START_OFFSET_ATTR=n.TIMESTAMP_ATTR=n.DATA_ATTR=void 0;n.DATA_ATTR="data-highlighted";n.TIMESTAMP_ATTR="data-timestamp";n.START_OFFSET_ATTR="data-start-offset";n.LENGTH_ATTR="data-length";n.IGNORE_TAGS=["SCRIPT","STYLE","SELECT","OPTION","BUTTON","OBJECT","APPLET","VIDEO","AUDIO","CANVAS","EMBED","PARAM","METER","PROGRESS"]},{}],2:[function(i,e,t){(function(e){"use strict";var t,n=(t=i("./text-highlighter"))&&t.__esModule?t:{default:t};i("./jquery-plugin"),e.TextHighlighter=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./jquery-plugin":5,"./text-highlighter":6}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,y=e("../utils/highlights"),O=e("../config"),N=(i=e("../utils/dom"))&&i.__esModule?i:{default:i},r=e("../utils/arrays");function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.el=e,this.options=t}return function(e,t,n){t&&a(e.prototype,t),n&&a(e,n)}(n,[{key:"highlightRange",value:function(e,t){if(!e||e.collapsed)return[];console.log("ALSDebug29: RANGE: ",e);var n=[],i=t.cloneNode(!0),r=(0,y.getElementOffset)(e.startContainer,this.el)+e.startOffset,o=e.startContainer===e.endContainer?r+(e.endOffset-e.startOffset):(0,y.getElementOffset)(e.endContainer,this.el)+e.endOffset;console.log("ALSDebug29: startOffset: ",r,"endOffset: ",o),i.setAttribute(O.START_OFFSET_ATTR,r),i.setAttribute(O.DATA_ATTR,!0),console.log("\n\n\n FINDING START CONTAINER FIRST TEXT NODE "),console.log("range.startContainer: ",e.startContainer);var l=(0,y.findTextNodeAtLocation)(e.startContainer,"start");console.log("\n\n\n FINDING END CONTAINER FIRST TEXT NODE "),console.log("range.endContainer: ",e.endContainer);var a=(0,y.findTextNodeAtLocation)(e.endContainer,"start");if(!l||!a)throw new Error("Failed to find the text node for the start or the end of the selected range");var s=e.endOffset<a.textContent.length-1?a.splitText(e.endOffset):a;if(l===a){var u=0<e.startOffset?l.splitText(e.startOffset):l,f=(0,N.default)(u).wrap(i);n.push(f)}else if(a.textContent.length>=e.endOffset){var h=l.splitText(e.startOffset),c=s.previousSibling;console.log("Node at the start of the new highlight: ",h),console.log("Node at the end of new highlight: ",c);var g,d,p=(0,y.findFirstNonSharedParent)({childElement:h,otherElement:c});if(p){var v=(0,y.extractElementContentForHighlight)({element:h,elementAncestor:p,options:this.options,locationInSelection:"start"});g=v.elementAncestorCopy,d=v.elementCopy,console.log("startElementParent:",p),console.log("startElementParentCopy: ",g)}var T,b=(0,y.findFirstNonSharedParent)({childElement:c,otherElement:h});if(b){var m=(0,y.extractElementContentForHighlight)({element:c,elementAncestor:b,options:this.options,locationInSelection:"end"});T=m.elementAncestorCopy,m.elementcopy,console.log("Node that is the wrapper of the end of the new highlight: ",b),console.log("Cloned of node that is the wrapper of the end of the new highlight after removing siblings and unwrapping highlight spans: ",T)}(0,y.addNodesToHighlightAfterElement)({element:d||h,elementAncestor:g,highlightWrapper:i,highlightedClass:this.options.highlightedClass});var E=(0,y.nodesInBetween)(l,a);console.log("CONTAINERS IN BETWEEN: ",E),E.forEach(function(e){i.appendChild(e)}),T?T.classList.contains(this.options.highlightedClass)?T.childNodes.forEach(function(e){i.appendChild(e)}):i.appendChild(T):i.appendChild(c),(0,N.default)(i).insertBefore(b||s)}return n}},{key:"doHighlight",value:function(e){var t,n,i=(0,N.default)(this.el).getRange();if(i&&!i.collapsed){if(!0===this.options.onBeforeHighlight(i)){n=+new Date,(t=(0,y.createWrapper)(this.options)).setAttribute(O.TIMESTAMP_ATTR,n);var r=(0,y.createDescriptors)({rootElement:this.el,range:i,wrapper:t}),o=this.options.onAfterHighlight(i,r,n);this.deserializeHighlights(o)}e||(0,N.default)(this.el).removeAllRanges()}}},{key:"normalizeHighlights",value:function(e){var t;return e.forEach(function(e){(0,N.default)(e).normalizeTextNodes()}),t=e.filter(function(e){return e.parentElement?e:null}),(t=(0,r.unique)(t)).sort(function(e,t){return e.offsetTop-t.offsetTop||e.offsetLeft-t.offsetLeft}),t}},{key:"removeHighlights",value:function(e){var t=e||this.el,n=this.getHighlights(),i=this;n.forEach(function(e){!0===i.options.onRemoveHighlight(e)&&function(e){e.className===t.className&&(0,N.default)(e).unwrap()}(e)})}},{key:"getHighlights",value:function(e){var t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(n,!0).forEach(function(e){l(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({container:this.el,dataAttr:O.DATA_ATTR,timestampAttr:O.TIMESTAMP_ATTR},e);return(0,y.retrieveHighlights)(t)}},{key:"isHighlight",value:function(e,t){return(0,y.isElementHighlight)(e,t)}},{key:"serializeHighlights",value:function(t){var e=this.getHighlights();if((0,y.sortByDepth)(e,!1),0===e.length)return[];var n=e.find(function(e){return e.classList.contains(t)});if(!n)return[];var i=n.getAttribute(O.LENGTH_ATTR),r=n.getAttribute(O.START_OFFSET_ATTR),o=n.cloneNode(!0);o.innerHTML="";var l=[o.outerHTML,(0,y.getHighlightedTextRelativeToRoot)({rootElement:this.el,startOffset:r,length:i}),r,i];return JSON.stringify([l])}},{key:"deserializeHighlights",value:function(e){var t,a=[],n=this;if(!e)return a;try{t=JSON.parse(e)}catch(e){throw"Can't parse JSON: "+e}return t.forEach(function(e){try{console.log("Highlight: ",e),function(e){var r,o,l={wrapper:e[0],text:e[1],offset:Number.parseInt(e[2]),length:Number.parseInt(e[3])},t=n.el;(0,y.findNodesAndOffsets)(l,t).forEach(function(e){var t=e.node,n=e.offset,i=e.length;(r=t.splitText(n)).splitText(i),r.nextSibling&&!r.nextSibling.nodeValue&&(0,N.default)(r.nextSibling).remove(),r.previousSibling&&!r.previousSibling.nodeValue&&(0,N.default)(r.previousSibling).remove(),o=(0,N.default)(r).wrap((0,N.default)().fromHTML(l.wrapper)[0]),a.push(o)})}(e)}catch(e){console&&console.warn&&console.warn("Can't deserialize highlight descriptor. Cause: "+e)}}),a}}]),n}();n.default=s},{"../config":1,"../utils/arrays":7,"../utils/dom":8,"../utils/highlights":10}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=e("../utils/highlights"),g=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};i.get||i.set?Object.defineProperty(t,n,i):t[n]=e[n]}return t.default=e,t}}(e("../utils/dom")),d=e("../config"),i=e("../utils/arrays");function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.el=e,this.options=t}return function(e,t,n){t&&l(e.prototype,t),n&&l(e,n)}(n,[{key:"highlightRange",value:function(e,t){if(!e||e.collapsed)return[];console.log("ALSDebug28: range before refined! ",e);for(var n,i,r,o=(0,c.refineRangeBoundaries)(e),l=o.startContainer,a=o.endContainer,s=o.goDeeper,u=!1,f=l,h=[];s&&f.nodeType===g.NODE_TYPE.TEXT_NODE&&(-1===d.IGNORE_TAGS.indexOf(f.parentNode.tagName)&&""!==f.nodeValue.trim()&&((i=t.cloneNode(!0)).setAttribute(d.DATA_ATTR,!0),r=f.parentNode,!(0,g.default)(this.el).contains(r)&&r!==this.el||(n=(0,g.default)(f).wrap(i),h.push(n))),s=!1),f!==a||a.hasChildNodes()&&s||(u=!0),f.tagName&&-1<d.IGNORE_TAGS.indexOf(f.tagName)&&(a.parentNode===f&&(u=!0),s=!1),s&&f.hasChildNodes()?f=f.firstChild:s=f.nextSibling?(f=f.nextSibling,!0):(f=f.parentNode,!1),!u;);return h}},{key:"normalizeHighlights",value:function(e){var t;return this.flattenNestedHighlights(e),this.mergeSiblingHighlights(e),t=e.filter(function(e){return e.parentElement?e:null}),(t=(0,i.unique)(t)).sort(function(e,t){return e.offsetTop-t.offsetTop||e.offsetLeft-t.offsetLeft}),t}},{key:"flattenNestedHighlights",value:function(u){var f=this;function e(){var s=!1;return u.forEach(function(e,t){var n=e.parentElement,i=n.previousSibling,r=n.nextSibling;if(f.isHighlight(n,d.DATA_ATTR))if((0,c.haveSameColor)(n,e))n.replaceChild(e.firstChild,e),u[t]=n,s=!0;else{if(e.nextSibling||(r?(0,g.default)(e).insertBefore(r):(0,g.default)(e).insertAfter(n),(0,g.default)(e).insertBefore(r||n),s=!0),e.previousSibling||(i?(0,g.default)(e).insertAfter(i):(0,g.default)(e).insertBefore(n),(0,g.default)(e).insertAfter(i||n),s=!0),e.previousSibling&&3==e.previousSibling.nodeType&&e.nextSibling&&3==e.nextSibling.nodeType){var o=document.createElement("span");o.style.backgroundColor=n.style.backgroundColor,o.className=n.className;var l=n.attributes[d.TIMESTAMP_ATTR].nodeValue;o.setAttribute(d.TIMESTAMP_ATTR,l),o.setAttribute(d.DATA_ATTR,!0);var a=o.cloneNode(!0);(0,g.default)(e.previousSibling).wrap(o),(0,g.default)(e.nextSibling).wrap(a),Array.prototype.slice.call(n.childNodes).forEach(function(e){(0,g.default)(e).insertBefore(e.parentNode)}),s=!0}n.hasChildNodes()||(0,g.default)(n).remove()}}),s}for((0,c.sortByDepth)(u,!0);e(););}},{key:"mergeSiblingHighlights",value:function(e){var n=this;function i(e,t){return t&&t.nodeType===g.NODE_TYPE.ELEMENT_NODE&&(0,c.haveSameColor)(e,t)&&n.isHighlight(t,d.DATA_ATTR)}e.forEach(function(e){var t=e.previousSibling,n=e.nextSibling;i(e,t)&&((0,g.default)(e).prepend(t.childNodes),(0,g.default)(t).remove()),i(e,n)&&((0,g.default)(e).append(n.childNodes),(0,g.default)(n).remove()),(0,g.default)(e).normalizeTextNodes()})}},{key:"doHighlight",value:function(e){var t,n,i,r,o=(0,g.default)(this.el).getRange();o&&!o.collapsed&&(!0===this.options.onBeforeHighlight(o)&&(r=+new Date,(t=(0,c.createWrapper)(this.options)).setAttribute(d.TIMESTAMP_ATTR,r),n=this.highlightRange(o,t),i=this.normalizeHighlights(n),this.options.onAfterHighlight||console.log("ALSDEbug24: Primitivo: this.options: ",this.options,"\n\n\n\n"),this.options.onAfterHighlight(o,i,r)),e||(0,g.default)(this.el).removeAllRanges())}},{key:"removeHighlights",value:function(e){var t=e||this.el,n=this.getHighlights({container:t}),i=this;function r(e){(0,g.default)(e).unwrap().forEach(function(e){!function(e){var t=e.previousSibling,n=e.nextSibling;t&&t.nodeType===g.NODE_TYPE.TEXT_NODE&&(e.nodeValue=t.nodeValue+e.nodeValue,(0,g.default)(t).remove()),n&&n.nodeType===g.NODE_TYPE.TEXT_NODE&&(e.nodeValue=e.nodeValue+n.nodeValue,(0,g.default)(n).remove())}(e)})}(0,c.sortByDepth)(n,!0),n.forEach(function(e){!0===i.options.onRemoveHighlight(e)&&r(e)})}},{key:"getHighlights",value:function(e){var t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(n,!0).forEach(function(e){o(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({container:this.el,dataAttr:d.DATA_ATTR,timestampAttr:d.TIMESTAMP_ATTR},e);return(0,c.retrieveHighlights)(t)}},{key:"isHighlight",value:function(e,t){return(0,c.isElementHighlight)(e,t)}},{key:"serializeHighlights",value:function(){var e=this.getHighlights(),o=this.el,l=[];return(0,c.sortByDepth)(e,!1),e.forEach(function(e){var t=0,n=e.textContent.length,i=function(e,t){for(var n,i=[];n=Array.prototype.slice.call(e.parentNode.childNodes),i.unshift(n.indexOf(e)),(e=e.parentNode)!==t||!e;);return i}(e,o),r=e.cloneNode(!0);r.innerHTML="",r=r.outerHTML,e.previousSibling&&e.previousSibling.nodeType===g.NODE_TYPE.TEXT_NODE&&(t=e.previousSibling.length),l.push([r,e.textContent,i.join(":"),t,n])}),JSON.stringify(l)}},{key:"deserializeHighlights",value:function(e){var t,a=[],s=this;if(!e)return a;try{t=JSON.parse(e)}catch(e){throw"Can't parse JSON: "+e}return t.forEach(function(e){try{!function(e){for(var t,n,i,r={wrapper:e[0],text:e[1],path:e[2].split(":"),offset:e[3],length:e[4]},o=r.path.pop(),l=s.el;i=r.path.shift();)l=l.childNodes[i];l.childNodes[o-1]&&l.childNodes[o-1].nodeType===g.NODE_TYPE.TEXT_NODE&&(o-=1),(t=(l=l.childNodes[o]).splitText(r.offset)).splitText(r.length),t.nextSibling&&!t.nextSibling.nodeValue&&(0,g.default)(t.nextSibling).remove(),t.previousSibling&&!t.previousSibling.nodeValue&&(0,g.default)(t.previousSibling).remove(),n=(0,g.default)(t).wrap((0,g.default)().fromHTML(r.wrapper)[0]),a.push(n)}(e)}catch(e){console&&console.warn&&console.warn("Can't deserialize highlight descriptor. Cause: "+e)}}),a}}]),n}();n.default=a},{"../config":1,"../utils/arrays":7,"../utils/dom":8,"../utils/highlights":10}],5:[function(e,t,n){"use strict";var i,r;"undefined"!=typeof jQuery&&(i=jQuery,r="textHighlighter",i.fn.textHighlighter=function(e){return this.each(function(){var t,n=this;i.data(n,r)||((t=new TextHighlighter(n,e)).destroy=function(e,t){return function(){t.call(this,e)}}(t.destroy,function(e){e.call(t),i(n).removeData(r)}),i.data(n,r,t))})},i.fn.getHighlighter=function(){return this.data(r)})},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=u(e("./utils/dom")),i=e("./utils/events"),r=u(e("./highlighters/primitivo")),o=u(e("./highlighters/independencia")),l=e("./config"),s=e("./utils/highlights");function u(e){return e&&e.__esModule?e:{default:e}}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function g(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}var d={primitivo:r.default,"v1-2014":r.default,independencia:o.default,"v2-2019":o.default},p=function(){function n(e,t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),!e)throw new Error("Missing anchor element");if(this.el=e,this.options=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(n,!0).forEach(function(e){h(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({color:"#ffff7b",highlightedClass:"highlighted",contextClass:"highlighter-context",version:"independencia",onRemoveHighlight:function(){return!0},onBeforeHighlight:function(){return!0},onAfterHighlight:function(){}},t),console.log("\n\n\n\nALSDEbug24: TextHighlighter: options constructor param: ",t),console.log("ALSDEbug24: TextHighlighter: this.options: ",this.options),!d[this.options.version])throw new Error("Please provide a valid version of the text highlighting functionality");this.highlighter=new d[this.options.version](this.el,this.options),(0,a.default)(this.el).addClass(this.options.contextClass),(0,i.bindEvents)(this.el,this)}return g(n,null,[{key:"createWrapper",value:function(e){return(0,s.createWrapper)(e)}}]),g(n,[{key:"destroy",value:function(){(0,i.unbindEvents)(this.el,this),(0,a.default)(this.el).removeClass(this.options.contextClass)}},{key:"highlightHandler",value:function(){this.doHighlight()}},{key:"doHighlight",value:function(e){this.highlighter.doHighlight(e)}},{key:"highlightRange",value:function(e,t){return this.highlighter.highlightRange(e,t)}},{key:"normalizeHighlights",value:function(e){return this.highlighter.normalizeHighlights(e)}},{key:"setColor",value:function(e){this.options.color=e}},{key:"getColor",value:function(){return this.options.color}},{key:"removeHighlights",value:function(e){this.highlighter.removeHighlights(e)}},{key:"getHighlights",value:function(e){return this.highlighter.getHighlights(e)}},{key:"isHighlight",value:function(e){return this.highlighter.isHighlight(e,l.DATA_ATTR)}},{key:"serializeHighlights",value:function(e){return this.highlighter.serializeHighlights(e)}},{key:"deserializeHighlights",value:function(e){return this.highlighter.deserializeHighlights(e)}},{key:"find",value:function(e,t){var n=(0,a.default)(this.el).getWindow(),i=n.scrollX,r=n.scrollY,o=void 0===t||t;if((0,a.default)(this.el).removeAllRanges(),n.find)for(;n.find(e,o);)this.doHighlight(!0);else if(n.document.body.createTextRange){var l=n.document.body.createTextRange();for(l.moveToElementText(this.el);l.findText(e,1,o?4:0)&&((0,a.default)(this.el).contains(l.parentElement())||l.parentElement()===this.el);)l.select(),this.doHighlight(!0),l.collapse(!1)}(0,a.default)(this.el).removeAllRanges(),n.scrollTo(i,r)}}]),n}();n.default=p},{"./config":1,"./highlighters/independencia":3,"./highlighters/primitivo":4,"./utils/dom":8,"./utils/events":9,"./utils/highlights":10}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.unique=function(e){return e.filter(function(e,t,n){return n.indexOf(e)===t})}},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.NODE_TYPE=void 0;var i={ELEMENT_NODE:1,TEXT_NODE:3};n.NODE_TYPE=i;function o(r){return{addClass:function(e){r.classList?r.classList.add(e):r.className+=" "+e},removeClass:function(e){r.classList?r.classList.remove(e):r.className=r.className.replace(new RegExp("(^|\\b)"+e+"(\\b|$)","gi")," ")},prepend:function(e){for(var t=Array.prototype.slice.call(e),n=t.length;n--;)r.insertBefore(t[n],r.firstChild)},append:function(e){for(var t=Array.prototype.slice.call(e),n=0,i=t.length;n<i;++n)r.appendChild(t[n])},insertAfter:function(e){return e.parentNode.insertBefore(r,e.nextSibling)},insertBefore:function(e){return e.parentNode.insertBefore(r,e)},remove:function(){r.parentNode.removeChild(r),r=null},contains:function(e){return r!==e&&r.contains(e)},wrap:function(e){return r.parentNode&&r.parentNode.insertBefore(e,r),e.appendChild(r),e},unwrap:function(){var t,e=Array.prototype.slice.call(r.childNodes);return e.forEach(function(e){t=e.parentNode,o(e).insertBefore(e.parentNode)}),o(t).remove(),e},parents:function(){for(var e,t=[];e=r.parentNode;)t.push(e),r=e;return t},parentsWithoutDocument:function(){return this.parents().filter(function(e){return e!==document})},nextClosestSibling:function(){for(var e,t=r;e=t.nextSibling,t=t.parentNode,!e&&t.parentNode;);return e},normalizeTextNodes:function(){if(r){if(r.nodeType===i.TEXT_NODE)for(;r.nextSibling&&r.nextSibling.nodeType===i.TEXT_NODE;)r.nodeValue+=r.nextSibling.nodeValue,r.parentNode.removeChild(r.nextSibling);else o(r.firstChild).normalizeTextNodes();o(r.nextSibling).normalizeTextNodes()}},color:function(){return r.style.backgroundColor},fromHTML:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes},getRange:function(){var e,t=o(r).getSelection();return 0<t.rangeCount&&(e=t.getRangeAt(0)),e},removeAllRanges:function(){o(r).getSelection().removeAllRanges()},getSelection:function(){return o(r).getWindow().getSelection()},getWindow:function(){return o(r).getDocument().defaultView},getDocument:function(){return r.ownerDocument||r},isAfter:function(e,t){for(var n=r.nextSibling,i=!1;n&&!i;)n===e?i=!0:n=n.nextSibling?n.nextSibling:r.parentNode.nextSibling;return i}}}n.default=o},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bindEvents=function(e,t){e.addEventListener("mouseup",t.highlightHandler.bind(t)),e.addEventListener("touchend",t.highlightHandler.bind(t))},n.unbindEvents=function(e,t){e.removeEventListener("mouseup",t.highlightHandler.bind(t)),e.removeEventListener("touchend",t.highlightHandler.bind(t))}},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.refineRangeBoundaries=function(e){var t=e.startContainer,n=e.endContainer,i=e.commonAncestorContainer,r=!0;if(0===e.endOffset){for(;!n.previousSibling&&n.parentNode!==i;)n=n.parentNode;n=n.previousSibling}else n.nodeType===f.NODE_TYPE.TEXT_NODE?e.endOffset<n.nodeValue.length&&n.splitText(e.endOffset):0<e.endOffset&&(n=n.childNodes.item(e.endOffset-1));t.nodeType===f.NODE_TYPE.TEXT_NODE?e.startOffset===t.nodeValue.length?r=!1:0<e.startOffset&&(t=t.splitText(e.startOffset),n===t.previousSibling&&(n=t)):t=e.startOffset<t.childNodes.length?t.childNodes.item(e.startOffset):t.nextSibling;return{startContainer:t,endContainer:n,goDeeper:r}},n.sortByDepth=function(e,n){e.sort(function(e,t){return(0,f.default)(n?t:e).parents().length-(0,f.default)(n?e:t).parents().length})},n.haveSameColor=function(e,t){return(0,f.default)(e).color()===(0,f.default)(t).color()},n.createWrapper=function(e){var t=document.createElement("span");return t.style.backgroundColor=e.color,t.className=e.highlightedClass,t},n.findTextNodeAtLocation=s,n.findNodesAndOffsets=function(e,t){var n=[],i=t,r=0,o=e.offset+e.length;for(;i&&r<o;){var l=i.textContent.length,a=r+l;if(a>e.offset)if(0===i.childNodes.length){var s=e.offset>r?e.offset-r:0,u=a<o?l-s:o-r-s;n.push({node:i,offset:s,length:u}),r=a,i=(0,f.default)(i).nextClosestSibling()}else i=i.childNodes[0];else r=a,i=i.nextSibling}return n},n.getElementOffset=a,n.findFirstNonSharedParent=h,n.extractElementContentForHighlight=function(e){var t=e.element,n=e.elementAncestor,i=e.options,r=e.locationInSelection,o=n.cloneNode(!0),l=s(o,"start"===r?"end":"start"),a=l.parentNode;(function(e,t){var n=e[t];for(;n;)e.parentNode.removeChild(n),n=n[t]})(l,c[r]),function(e,t){var n=e[t];for(;n;)n.nodeType===f.NODE_TYPE.TEXT_NODE&&(e.textContent+=n.textContent,e.parentNode.removeChild(n),n=n[t])}(l,g[r]),console.log("elementCopy: ",l),console.log("elementCopyParent: ",a),a!==o&&a.classList.contains(i.highlightedClass)&&(0,f.default)(a).unwrap();return t.parentNode.removeChild(t),{elementAncestorCopy:o,elementCopy:l}},n.nodesInBetween=function(e,t){if(e===t)return[];var n=d(e,t),i=n.foundEndNodeSibling,r=n.gatheredSiblings;if(i)return r;var o=h({childElement:e,otherElement:t});if(o){var l=d(o,t),a=l.foundEndNodeSibling,s=l.gatheredSiblings;if(a)return s}return[]},n.groupHighlights=o,n.retrieveHighlights=function(e){var t=(e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(n,!0).forEach(function(e){r(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({andSelf:!0,grouped:!1},e)).container.querySelectorAll("["+e.dataAttr+"]"),n=Array.prototype.slice.call(t);!0===e.andSelf&&e.container.hasAttribute(e.dataAttr)&&n.push(e.container);e.grouped&&(n=o(n,e.timestampAttr));return n},n.isElementHighlight=function(e,t){return e&&e.nodeType===f.NODE_TYPE.ELEMENT_NODE&&e.hasAttribute(t)},n.addNodesToHighlightAfterElement=function(e){var t=e.element,n=e.elementAncestor,i=e.highlightWrapper,r=e.highlightedClass;n?n.classList.contains(r)?n.childNodes.forEach(function(e){n.appendChild(e)}):i.appendChild(n):i.appendChild(t)},n.getHighlightedTextForRange=p,n.getHighlightedTextRelativeToRoot=function(e){var t=e.rootElement,n=e.startOffset,i=e.length,r=t.textContent.substring(n,Number.parseInt(n)+Number.parseInt(i)),o=document.createTextNode(r),l=document.createElement("div");return l.appendChild(o),l.innerText},n.createDescriptors=function(e){var t=e.rootElement,n=e.range,i=e.wrapper.cloneNode(!0),r=a(n.startContainer,t)+n.startOffset,o=(n.startContainer===n.endContainer?r+(n.endOffset-n.startOffset):a(n.endContainer,t)+n.endOffset)-r;return i.setAttribute(l.DATA_ATTR,!0),i.innerHTML="",[[i.outerHTML,p(n),r,o]]};var f=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};i.get||i.set?Object.defineProperty(t,n,i):t[n]=e[n]}return t.default=e,t}}(e("./dom")),l=e("../config");function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){console.log("Element as parameter: ",e);for(var n=e,i=0;n&&n.nodeType!==f.NODE_TYPE.TEXT_NODE;){if(console.log("textNodeElement step ".concat(i),n),"start"===t)n=0<n.childNodes.length?n.childNodes[0]:n.nextSibling;else if("end"===t)if(0<n.childNodes.length){var r=n.childNodes.length-1;n=n.childNodes[r]}else n=n.previousSibling;else n=null;i++}return console.log("text node element returned: ",n),n}function a(e,t){var n,i=0,r=e;do{var o=(n=Array.prototype.slice.call(r.parentNode.childNodes)).indexOf(r);i+=u(n,o),r=r.parentNode}while(r!==t||!r);return i}function u(e,t){for(var n=0,i=0;i<t;i++){var r=e[i].textContent;r&&0<r.length&&(n+=r.length)}return n}function h(e){for(var t=e.childElement,n=e.otherElement,i=(0,f.default)(t).parentsWithoutDocument(),r=0,o=null,l=!1;!o&&!l&&r<i.length;){var a=i[r];a.contains(n)&&(console.log("currentParent contains other element!",a),0<r?o=i[r-1]:l=!0),r++}return o}var c={start:"previousSibling",end:"nextSibling"},g={start:"nextSibling",end:"previousSibling"};function d(e,t){for(var n=[],i=!1,r=e.nextSibling;r&&!i;)r===t||r.contains(t)?i=!0:(n.push(r),r=r.nextSibling);return{gatheredSiblings:n,foundEndNodeSibling:i}}function o(e,n){var i=[],r={},o=[];return e.forEach(function(e){var t=e.getAttribute(n);void 0===r[t]&&(r[t]=[],i.push(t)),r[t].push(e)}),i.forEach(function(e){var t=r[e];o.push({chunks:t,timestamp:e,toString:function(){return t.map(function(e){return e.textContent}).join("")}})}),o}function p(e){return e.extractContents().innerText}},{"../config":1,"./dom":8}]},{},[2]);